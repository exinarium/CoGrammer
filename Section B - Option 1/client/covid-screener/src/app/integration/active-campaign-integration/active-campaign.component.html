<div class="container p-3">
    <div class="row">
        <div class="col text-center">
            <h3>Integrate with Active Campaign</h3>
        </div>
    </div>
    <div class="card w-100 mt-2">
        <div class="card-body">
            <span *ngIf="startPage">
                <div class="row mt-3 fluid">
                    <div class="col">
                        <p>To start pushing your contacts to Active campaign follow these steps:</p>
                        <ul class="p-1 m-0">
                            <li class="m-1">
                                Create a list in your Active Campaign Account
                            </li>
                            <li class="m-1">
                                Inside Active Campaign navigate to Settings -> Developer
                            </li>
                            <li class="m-1">
                                Copy the API URL and API Key into the requested boxes in the 2020 Screener
                            </li>
                            <li class="m-1">
                                Click on Find Lists and select your list
                            </li>
                            <li class="m-1">
                                Save the integration
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row mt-3 fluid">
                    <div class="col">
                        <a id="active-campaign-button" class="btn btn-primary text-white w-100"
                            (click)="startIntegration()">
                            <img src="../../../assets/icons/activecampaign-logo.png" width="30" /> Setup Active Campaign
                        </a>
                    </div>
                </div>
            </span>
            <form #form *ngIf="!startPage" class="needs-validation">
                <div class="row mt-3 fluid">
                    <div class="col">
                        <div class="form-group">
                            <label for="formGroupApiUrlInput">API URL</label>
                            <input class="form-control" id="formGroupApiUrlInput" placeholder="API URL"
                              [(ngModel)]="apiUrl" name="apiUrl" required/>
                            <div class="invalid-feedback">
                              Please provide a valid API URL
                            </div>
                          </div>
                    </div>
                </div>
                <div class="row mt-3 fluid">
                    <div class="col">
                        <div class="form-group">
                            <label for="formGroupApiKeyInput">API Key</label>
                            <input class="form-control" id="formGroupApiKeyInput" placeholder="API Key"
                              [(ngModel)]="apiKey" name="apiKey" required/>
                            <div class="invalid-feedback">
                              Please provide a valid API Key
                            </div>
                          </div>
                    </div>
                </div>
                <div class="row mt-3 fluid">
                    <div class="col">
                        <div class="form-group">
                            <button class="btn btn-secondary w-100" (click)="getLists()">Find Lists <i class="fas fa-search"></i></button>
                          </div>
                    </div>
                </div>
                <div class="row mt-3 fluid">
                    <div class="col">
                        <div class="form-group">
                            <label for="formGroupListInput">Contact List</label>
                            <select class="form-control" name="listId" [(ngModel)]="listId" required>
                                <option value="0" disabled selected>Select List</option>
                                <option *ngFor="let list of lists" [value]="list.listId">{{list.listName}}</option>
                            </select>
                            <div class="invalid-feedback">
                              Please select a valid List
                            </div>
                          </div>
                    </div>
                </div>
                <div class="row mt-3 fluid">
                    <div class="col">
                        <div class="form-group">
                            <button class="btn btn-primary w-100" (click)="storeIntegration()" [disabled]="!listId || listId === 0">Save Integration</button>
                          </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div id="loader-active-campaign" class="modal fade" data-backdrop="static" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered justify-content-center" role="document">
        <div class="modal-content" style="background-color: transparent; border: none;">
            <div class="container">
                <div class="row">
                    <div class="col text-center">
                        <div class="spinner-border text-danger spinner-border-lg" role="status"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>